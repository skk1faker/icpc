## 题义
给定一个串的长度，串中每个字符有两种情况"$O$"、"$X$"，不同位置两种字符产生的概率不同，对于每种字符串的权值计算方式是将串中连续"$O$"长度平方和计算出来，例如"$OOOXXOOXXXXOO$"权值为$3^2 + 2 ^ 2 + 2^2$
## 题解

假设长度为$i$的串其权值期望已经求出为$L_i$，在i串面再加一个字符a[i+1],其为$O$的概率为$p\{a[i+1] == O\}$，那么每种字符串（因为每个位置的字符与概率有关）的权值变化情况与每种情况的从字符串最后一个位置开始连续的$O$的长度有关，假设对于某情况从字符串最后一个位置开始连续的$O$的长度为$k$,此时的权值为$l$，那么新加一个字符之后，权值变化函数$change(k)$为如下计算：   
$$\begin{aligned}
change(k) &= (p\{a[i+1] == O\} *  (l + 2*k + 1)+ p\{a[i+1] == X\} * l) - l \\
       &= p\{a[i+1] == O\} * (2 * k + 1) 
\end{aligned}$$ 

如果假设将每种情况按照字符串最后一个位置开始连续的$O$的长度来分类，那么$P_k$设为最后一个位置开始连续的$O$的长度为$k$的概率，于是我们可以看看加入a[i+1]之后字符串的权值期望变化$L_{i+1} - L_{i}$

$$\begin{aligned}
L_{i+1} - L_{i} &= \sum_{k = 0}^{i}change(k) \times P_k\\
                &= \sum_{k = 0}^{i} p\{a[i+1] == O\} * (2 * k + 1) * P_k\\
                &= p\{a[i+1] == O\} \sum_{k = 0}^{i}(2 * k + 1) * P_k\\
                &= p\{a[i+1] == O\} * (2\sum_{k = 0}^{i}k * P_k + \sum_{k = 0}^{i}P_k)\\ 
                & 注意只有在k从0开始的时候\sum_{k = 0}^{i}P_k = 1\\
                &= p\{a[i+1] == O\} * (2E_i(k) + 1)\\ 
\end{aligned}$$
可以看到对于已知期望权值之后我们只要知道最后一个位置开始连续的$O$的长度的期望即可计算加入下一位之后得到的贡献，然后就可以不断地推，现在的问题是如何求出E_i(k)

已知,以下两种形式等价
$$\begin{aligned} E_i(k) &= \sum_{k = 0}^{i} P_k*k\\E_i(k) &= \sum_{k = 1}^{i} P_k*k \end{aligned}$$ 
于是
$$\begin{aligned} 
E_{i+1}(k) &= \sum_{k+1 = 1}^{k+1 <= i+1} (k+1) * P_k * P\{a[i+1] == O\}\\
           &=  P\{a[i+1] == O\}\sum_{k = 0}^{k <= i}(k+1)*P_k\\
           &= P\{a[i+1] == O\}(\sum_{k = 0}^{k <= i}P_k + E_i(k))\\
           &= P\{a[i+1] == O\}(1 + E_i(k))\\
\end{aligned}$$

于是E和